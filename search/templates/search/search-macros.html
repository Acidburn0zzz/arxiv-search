{% macro pagination(metadata, url_for_page) -%}
  <nav class="pagination is-small is-centered" role="navigation" aria-label="pagination">
    {% if metadata.current_page > 1 %}
    <a href="{{ url_for_page(metadata.current_page - 1, metadata.page_size) }}"
      class="pagination-previous">Previous
    </a>
    {% endif %}
    {% if metadata.current_page < metadata.total_pages %}
    <a  href="{{ url_for_page(metadata.current_page + 1, metadata.page_size) }}"
      class="pagination-next">Next page</a>
    {% endif %}
    <ul class="pagination-list">
      {% if metadata.current_page > 1 %}
        <li>
          <a href="{{ url_for_page(1, metadata.page_size) }}"
            class="pagination-link"
            aria-label="Goto page 1">1
          </a>
        </li>
      {% endif %}
      {% if metadata.current_page > 2 %}
        <li><span class="pagination-ellipsis">&hellip;</span></li>
        <li>
          <a href="{{ url_for_page(metadata.current_page - 1, metadata.page_size) }}"
            class="pagination-link"
            aria-label="Goto page {{ metadata.current_page - 1}}">{{ metadata.current_page - 1}}
          </a>
        </li>
      {% endif %}
      <li>
        <a href="{{ url_for_page(metadata.current_page, metadata.page_size) }}"
          class="pagination-link is-current"
          aria-label="Page {{ metadata.current_page }}"
          aria-current="page">{{ metadata.current_page }}
        </a>
      </li>
      {% if metadata.current_page < metadata.total_pages %}
        <li>
          <a href="{{ url_for_page(metadata.current_page + 1, metadata.page_size) }}"
            class="pagination-link"
            aria-label="Goto page {{ metadata.current_page + 1 }}">{{ metadata.current_page + 1}}
          </a>
        </li>
      {% endif %}
      {% if metadata.current_page < metadata.total_pages - 1 %}
        <li><span class="pagination-ellipsis">&hellip;</span></li>
        <li>
          <a href="{{ url_for_page(metadata.total_pages, metadata.page_size) }}"
            class="pagination-link"
            aria-label="Goto page {{ metadata.total_pages }}">{{ metadata.total_pages }}
          </a>
        </li>
      {% endif %}
    </ul>
  </nav>
{%- endmacro %}


{% macro search_results(form, results, metadata, external_url, url_for_page) %}
<div class="level">
  <div class="level-left">
    <div class="level-item">
        <span class="select is-small">
          {{ form.results_per_page|safe }}
        </span>
        {{ form.results_per_page.label }}
    </div>

    <!-- sort select -->
    <div class="field is-horizontal level-item">
      <div class="control">
        <div class="field-label">
          <label class="label is-small">Sort results by:</label>
        </div>
        <div class="select is-small">
          <select>
            <option>All fields</option>
            <option>Author</option>
            <option>Date</option>
          </select>
        </div>
      </div>
    </div> <!-- endsort -->

  </div>
</div>
<ol>

{% if metadata.total_pages > 1 %}
  {{ pagination(metadata, url_for_page) }}
{% endif %}

{% for result in results %}
  <li class="arxiv-result">
    <p class="list-title"><a href="{{ external_url('browse', 'abstract', paper_id=result.paper_id) }}">arXiv: {{ result.paper_id }}</a> [<a href="{{ external_url('browse', 'pdf', paper_id=result.paper_id) }}">pdf</a>] <span class="tag is-small is-link">{{ result.primary_classification.category.id }}</span>
    {% if result.secondary_category %}
      {% for secondary in result.secondary_category %}
        <span class="tag is-small is-grey">{{ secondary.archive }} {{ secondary.category }}</span>
      {% endfor %}
    {% endif -%}
    </p>
    <p class="title is-5">{{ result.title }}</p>
    <p class="authors">Authors:
      {% for author in result.authors %}
        <a href="">{{ author.first_name }} {{ author.last_name }}{% if author.suffix %} {{ author.suffix }}{%- endif -%}</a>
        {%- if author.affiliation %}
         ( {{ author.affiliation|join(', ') }} )
        {% endif -%}
        {{ ", " if not loop.last }}
      {% endfor -%}
    </p>
    <p class="comments">Comments: {{ result.comments }}</p>
    {% if result.journal_ref %}
      <p class="comments">Journal Reference: {{ result.journal_ref }}</p>
    {% endif %}
  </li>
{% endfor %}
</ol>

{% if metadata.total_pages > 1 %}
  {{ pagination(metadata, url_for_page) }}
{% endif %}

{%- endmacro -%}
