{%- extends "search/base.html" %}

{% import "search/search-macros.html" as search_macros %}

{% block title %}
    {% if results %}
        Showing {{ metadata.total }} results for {{ query.field }}: {{ query.value }}
    {% else %}
        Search
    {% endif %}
{% endblock title %}

{% block within_content %}

<form method="GET" action="{{ url_for('ui.search') }}">
  <div class="field has-addons">
    <div class="control is-expanded">
      {% if form.query.errors %}
        {{ form.query(class="input is-medium is-warning")|safe }}
      {% else %}
        {{ form.query(class="input is-medium")|safe }}
      {% endif %}
      {% if form.query.errors %}
        <div class="help is-warning">
          {% for error in form.query.errors %}
              {{ error }}
          {% endfor %}
        </div>
      {% endif %}
    </div>
    <div class="select control is-medium">
      {{ form.searchtype(class="is-medium")|safe }}
    </div>
    <div class="control">
        <button class="button is-link is-medium">Search</button>
    </div>
  </div>
  <div class="level">
    <div class="field is-horizontal is-grouped level-left">
      <div class="control">
        <span class="select is-small">
          {{ form.size|safe }}
        </span>
        {{ form.size.label }}.
      </div>
      <div class="control">
        {{ form.order.label }}
        <span class="select is-small">
          {{ form.order|safe }}
        </span>
      </div>
    </div>
    <div class="level-right">
      <a href="{{ url_for('ui.advanced_search') }}">Advanced</a> |  <a href="{{ url_for('ui.author_search') }}">Authors</a>
    </div>
  </div>
</form>

{% if query and not results %}
  <div class="is-size-4 has-text-warning">
    Sorry, your query for <span class="is-warning">{{ query.field }}: {{ query.value }}</span> produced no results.
  </div>
{% endif %}

{% if results %}
    {{ search_macros.size_and_order(form, url_for('ui.search')) }}
    {{ search_macros.search_results(form, results, metadata, external_url, url_for_page) }}
{% endif %}

{% endblock %}
